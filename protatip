<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Космическая игра "Планетарная память"</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0a0a2a;
            --secondary: #1a1a4a;
            --accent: #4a9ff5;
            --accent2: #9a4ff0;
            --text: #ffffff;
            --text-secondary: #a0c8f8;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --card-bg: rgba(16, 30, 66, 0.8);
            --star-color: rgba(255, 255, 255, 0.8);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Orbitron', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: var(--primary);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Анимированный космический фон */
        .space-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            overflow: hidden;
        }
        
        .nebula {
            position: absolute;
            border-radius: 50%;
            opacity: 0.1;
            filter: blur(60px);
        }
        
        .nebula-1 {
            width: 800px;
            height: 800px;
            background: radial-gradient(circle, var(--accent), transparent);
            top: -300px;
            left: -200px;
            animation: float 25s infinite alternate ease-in-out;
        }
        
        .nebula-2 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, var(--accent2), transparent);
            bottom: -200px;
            right: -100px;
            animation: float 30s infinite alternate-reverse ease-in-out;
        }
        
        .stars-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }
        
        .star {
            position: absolute;
            background-color: var(--star-color);
            border-radius: 50%;
        }
        
        .shooting-star {
            position: absolute;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, transparent, white);
            opacity: 0;
        }
        
        .planet-background {
            position: fixed;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            z-index: -1;
            opacity: 0.05;
            filter: blur(20px);
        }
        
        .planet-1 {
            background: radial-gradient(circle, #4a9ff5, #1a5fb4);
            top: 10%;
            right: 5%;
            animation: orbit 60s infinite linear;
        }
        
        .planet-2 {
            background: radial-gradient(circle, #9a4ff0, #6b3fa0);
            bottom: 15%;
            left: 8%;
            animation: orbit 80s infinite linear reverse;
        }
        
        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(50px, 30px) scale(1.05); }
        }
        
        @keyframes orbit {
            from { transform: rotate(0deg) translateX(200px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(200px) rotate(-360deg); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px var(--accent); }
            50% { box-shadow: 0 0 30px var(--accent); }
        }
        
        @keyframes cardFlip {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(180deg); }
        }
        
        @keyframes flyIn {
            0% { transform: translateY(-100px) scale(0.5); opacity: 0; }
            100% { transform: translateY(0) scale(1); opacity: 1; }
        }
        
        /* Основные стили */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0 40px;
            position: relative;
            animation: flyIn 1s ease-out;
        }
        
        .logo {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            font-size: 3.5rem;
            color: var(--accent);
            animation: pulse 3s infinite;
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 20px rgba(74, 159, 245, 0.5);
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-around;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(74, 159, 245, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: flyIn 1s ease-out 0.2s both;
        }
        
        .info-box {
            text-align: center;
            padding: 10px;
            flex: 1;
            position: relative;
        }
        
        .info-box:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 20%;
            height: 60%;
            width: 2px;
            background: linear-gradient(to bottom, transparent, var(--accent), transparent);
        }
        
        .info-label {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .info-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--text);
            text-shadow: 0 0 10px var(--accent);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 40px;
            animation: flyIn 1s ease-out 0.4s both;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(26, 95, 180, 0.4);
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s;
            z-index: -1;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(26, 95, 180, 0.6);
        }
        
        .btn:active {
            transform: translateY(2px);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            box-shadow: 0 8px 20px rgba(243, 156, 18, 0.4);
        }
        
        .btn-warning:hover {
            box-shadow: 0 12px 25px rgba(243, 156, 18, 0.6);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
        }
        
        .btn-danger:hover {
            box-shadow: 0 12px 25px rgba(231, 76, 60, 0.6);
        }
        
        .difficulty-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            animation: flyIn 1s ease-out 0.6s both;
        }
        
        .difficulty-btn {
            padding: 12px 25px;
            border-radius: 10px;
            background: rgba(16, 30, 66, 0.5);
            border: 2px solid transparent;
            color: var(--text-secondary);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .difficulty-btn:hover {
            transform: translateY(-3px);
            border-color: var(--accent);
        }
        
        .difficulty-btn.active {
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            color: white;
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(74, 159, 245, 0.4);
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 40px;
            animation: flyIn 1s ease-out 0.8s both;
        }
        
        @media (max-width: 1200px) {
            .game-board {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .info-value {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }
        
        .card {
            height: 220px;
            perspective: 1000px;
            cursor: pointer;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
        }
        
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        
        .card.matched .card-inner {
            animation: glow 2s infinite;
            box-shadow: 0 0 30px var(--success);
        }
        
        .card.mismatched .card-inner {
            animation: shake 0.5s;
            box-shadow: 0 0 30px var(--danger);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 20px;
            overflow: hidden;
        }
        
        .card-front {
            background: linear-gradient(135deg, #0c1a3a, #1a3a6e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 3px solid rgba(74, 159, 245, 0.3);
            padding: 20px;
        }
        
        .card-front::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
            opacity: 0.3;
        }
        
        .card-front i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--accent);
            text-shadow: 0 0 20px var(--accent);
        }
        
        .card-front p {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }
        
        .card-back {
            background: linear-gradient(135deg, #1a3a6e, #0c1a3a);
            transform: rotateY(180deg);
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 3px solid var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        .card-back::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(74, 159, 245, 0.1) 0%, transparent 70%);
            z-index: 0;
        }
        
        .planet-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            z-index: 1;
            position: relative;
        }
        
        .planet-name {
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--accent);
            z-index: 1;
            position: relative;
            text-shadow: 0 0 10px var(--accent);
        }
        
        .planet-desc {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.4;
            z-index: 1;
            position: relative;
        }
        
        .planet-stats {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 15px;
            z-index: 1;
            position: relative;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: white;
        }
        
        .message-container {
            text-align: center;
            padding: 20px;
            margin-bottom: 30px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(74, 159, 245, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: flyIn 1s ease-out 1s both;
        }
        
        #message {
            font-size: 1.3rem;
            color: var(--text);
            text-shadow: 0 0 10px var(--accent);
        }
        
        .completion {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-top: 10px;
        }
        
        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-secondary);
            font-size: 1rem;
            border-top: 1px solid rgba(74, 159, 245, 0.2);
            margin-top: 40px;
            animation: flyIn 1s ease-out 1.2s both;
        }
        
        .win-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }
        
        .win-content {
            background: linear-gradient(135deg, #0c1a3a, #1a3a6e);
            padding: 50px;
            border-radius: 30px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            border: 3px solid var(--accent);
            box-shadow: 0 0 60px rgba(74, 159, 245, 0.8);
            position: relative;
            overflow: hidden;
            animation: flyIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .win-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>');
            opacity: 0.3;
        }
        
        .win-content h2 {
            font-size: 3rem;
            color: var(--accent);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--accent);
            z-index: 1;
            position: relative;
        }
        
        .win-content p {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--text);
            z-index: 1;
            position: relative;
        }
        
        .win-stats {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            z-index: 1;
            position: relative;
        }
        
        .win-stat {
            text-align: center;
        }
        
        .win-stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 10px var(--accent);
        }
        
        .win-stat-label {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }
        
        .rating {
            font-size: 2rem;
            color: #f1c40f;
            margin: 20px 0;
            z-index: 1;
            position: relative;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(16, 30, 66, 0.7);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            border: 1px solid rgba(74, 159, 245, 0.3);
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- Анимированный космический фон -->
    <div class="space-background">
        <div class="nebula nebula-1"></div>
        <div class="nebula nebula-2"></div>
        <div class="stars-container" id="starsContainer"></div>
        <div class="planet-background planet-1"></div>
        <div class="planet-background planet-2"></div>
    </div>
    
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-rocket logo-icon"></i>
                <h1>ПЛАНЕТАРНАЯ ПАМЯТЬ</h1>
                <i class="fas fa-satellite logo-icon"></i>
            </div>
            <p class="subtitle">Исследуй космос и найди все пары планет Солнечной системы</p>
        </header>
        
        <div class="game-info">
            <div class="info-box">
                <div class="info-label"><i class="fas fa-footsteps"></i> ХОДЫ</div>
                <div class="info-value" id="moves">0</div>
            </div>
            <div class="info-box">
                <div class="info-label"><i class="fas fa-star"></i> СОВПАДЕНИЯ</div>
                <div class="info-value" id="matches">0 / 8</div>
            </div>
            <div class="info-box">
                <div class="info-label"><i class="fas fa-clock"></i> ВРЕМЯ</div>
                <div class="info-value" id="timer">00:00</div>
            </div>
            <div class="info-box">
                <div class="info-label"><i class="fas fa-tachometer-alt"></i> СЛОЖНОСТЬ</div>
                <div class="info-value" id="difficulty">СРЕДНИЙ</div>
            </div>
        </div>
        
        <div class="difficulty-selector">
            <button class="difficulty-btn" data-level="easy">ЛЁГКИЙ (4 пары)</button>
            <button class="difficulty-btn active" data-level="medium">СРЕДНИЙ (8 пар)</button>
            <button class="difficulty-btn" data-level="hard">СЛОЖНЫЙ (12 пар)</button>
        </div>
        
        <div class="controls">
            <button class="btn" id="startBtn"><i class="fas fa-play"></i> НОВАЯ ИГРА</button>
            <button class="btn btn-warning" id="hintBtn"><i class="fas fa-lightbulb"></i> ПОДСКАЗКА (3)</button>
            <button class="btn" id="soundBtn"><i class="fas fa-volume-up"></i> ЗВУК: ВКЛ</button>
            <button class="btn btn-danger" id="resetBtn"><i class="fas fa-redo"></i> СБРОСИТЬ</button>
        </div>
        
        <div class="game-board" id="gameBoard">
            <!-- Карточки будут сгенерированы JavaScript -->
        </div>
        
        <div class="message-container">
            <div>
                <div id="message">Нажмите "НОВАЯ ИГРА", чтобы начать космическое приключение!</div>
                <div class="completion">Прогресс: <span id="progress">0</span>%</div>
                <div class="progress-bar">
                    <div class="progress" id="progressBar"></div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Космическая игра "Планетарная память" | Исследуй Солнечную систему | © 2023 Космические технологии</p>
    </footer>
    
    <div class="win-overlay" id="winOverlay">
        <div class="win-content">
            <h2><i class="fas fa-trophy"></i> ПОБЕДА!</h2>
            <p>Вы успешно исследовали все планеты Солнечной системы!</p>
            
            <div class="win-stats">
                <div class="win-stat">
                    <div class="win-stat-value" id="finalMoves">0</div>
                    <div class="win-stat-label">ХОДЫ</div>
                </div>
                <div class="win-stat">
                    <div class="win-stat-value" id="finalTime">00:00</div>
                    <div class="win-stat-label">ВРЕМЯ</div>
                </div>
                <div class="win-stat">
                    <div class="win-stat-value" id="finalScore">0</div>
                    <div class="win-stat-label">ОЧКИ</div>
                </div>
            </div>
            
            <div class="rating" id="ratingStars">
                <!-- Звезды рейтинга будут добавлены через JS -->
            </div>
            
            <p id="winMessage">Отличный результат! Вы - настоящий космический исследователь!</p>
            <button class="btn" id="playAgainBtn"><i class="fas fa-play"></i> ИГРАТЬ СНОВА</button>
        </div>
    </div>

    <script>
        // Данные о планетах с дополнительной информацией
        const planets = [
            {
                name: "Меркурий",
                description: "Самая маленькая и близкая к Солнцу планета. Не имеет спутников.",
                icon: "fas fa-temperature-high",
                color: "#8c8c8c",
                diameter: "4879 км",
                distance: "57.9 млн км",
                moons: 0
            },
            {
                name: "Венера",
                description: "Самая горячая планета с плотной токсичной атмосферой.",
                icon: "fas fa-fire",
                color: "#e6b87e",
                diameter: "12104 км",
                distance: "108.2 млн км",
                moons: 0
            },
            {
                name: "Земля",
                description: "Единственная известная планета с жизнью. Имеет один спутник - Луну.",
                icon: "fas fa-globe-americas",
                color: "#6b93d6",
                diameter: "12742 км",
                distance: "149.6 млн км",
                moons: 1
            },
            {
                name: "Марс",
                description: "Красная планета, названа в честь бога войны. Имеет два спутника.",
                icon: "fas fa-mountain",
                color: "#c1440e",
                diameter: "6779 км",
                distance: "227.9 млн км",
                moons: 2
            },
            {
                name: "Юпитер",
                description: "Самая большая планета в Солнечной системе. Газовая планета-гигант.",
                icon: "fas fa-wind",
                color: "#d8ca9d",
                diameter: "139820 км",
                distance: "778.5 млн км",
                moons: 79
            },
            {
                name: "Сатурн",
                description: "Известна своими впечатляющими кольцами из льда и камней.",
                icon: "fas fa-ring",
                color: "#e4cd9e",
                diameter: "116460 км",
                distance: "1.43 млрд км",
                moons: 82
            },
            {
                name: "Уран",
                description: "Ледяной гигант, вращается на боку. Имеет слабые кольца.",
                icon: "fas fa-snowflake",
                color: "#d1e7e7",
                diameter: "50724 км",
                distance: "2.87 млрд км",
                moons: 27
            },
            {
                name: "Нептун",
                description: "Самый ветреный мир в Солнечной системе. Открыт математически.",
                icon: "fas fa-water",
                color: "#5b5bff",
                diameter: "49244 км",
                distance: "4.5 млрд км",
                moons: 14
            },
            {
                name: "Плутон",
                description: "Карликовая планета в поясе Койпера. Имеет пять спутников.",
                icon: "fas fa-icicles",
                color: "#a6a6a6",
                diameter: "2377 км",
                distance: "5.9 млрд км",
                moons: 5
            },
            {
                name: "Церера",
                description: "Карликовая планета в поясе астероидов. Самый крупный астероид.",
                icon: "fas fa-gem",
                color: "#b0b0b0",
                diameter: "946 км",
                distance: "413.7 млн км",
                moons: 0
            },
            {
                name: "Эрида",
                description: "Карликовая планета, находящаяся дальше Плутона.",
                icon: "fas fa-glacier",
                color: "#cccccc",
                diameter: "2326 км",
                distance: "10.12 млрд км",
                moons: 1
            },
            {
                name: "Хаумеа",
                description: "Карликовая планета яйцевидной формы в поясе Койпера.",
                icon: "fas fa-egg",
                color: "#e0e0e0",
                diameter: "≈1960 км",
                distance: "6.43 млрд км",
                moons: 2
            }
        ];

        // Игровые переменные
        let gameStarted = false;
        let moves = 0;
        let matches = 0;
        let firstCard = null;
        let secondCard = null;
        let lockBoard = false;
        let timer = 0;
        let timerInterval = null;
        let difficulty = "medium"; // easy, medium, hard
        let totalPairs = 8;
        let totalCards = 16;
        let hints = 3;
        let soundEnabled = true;
        let gamePlanets = [];

        // DOM элементы
        const gameBoard = document.getElementById('gameBoard');
        const movesDisplay = document.getElementById('moves');
        const matchesDisplay = document.getElementById('matches');
        const timerDisplay = document.getElementById('timer');
        const difficultyDisplay = document.getElementById('difficulty');
        const messageDisplay = document.getElementById('message');
        const progressDisplay = document.getElementById('progress');
        const progressBar = document.getElementById('progressBar');
        const startBtn = document.getElementById('startBtn');
        const hintBtn = document.getElementById('hintBtn');
        const soundBtn = document.getElementById('soundBtn');
        const resetBtn = document.getElementById('resetBtn');
        const winOverlay = document.getElementById('winOverlay');
        const finalMoves = document.getElementById('finalMoves');
        const finalTime = document.getElementById('finalTime');
        const finalScore = document.getElementById('finalScore');
        const ratingStars = document.getElementById('ratingStars');
        const winMessage = document.getElementById('winMessage');
        const playAgainBtn = document.getElementById('playAgainBtn');
        const difficultyButtons = document.querySelectorAll('.difficulty-btn');
        const starsContainer = document.getElementById('starsContainer');

        // Создание звездного фона с анимацией
        function createStars() {
            starsContainer.innerHTML = '';
            
            // Создаем статические звезды
            for (let i = 0; i < 200; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                
                // Случайный размер и позиция
                const size = Math.random() * 3 + 1;
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                const duration = Math.random() * 5 + 2;
                const opacity = Math.random() * 0.8 + 0.2;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${x}%`;
                star.style.top = `${y}%`;
                star.style.opacity = opacity;
                star.style.animation = `twinkle ${duration}s infinite alternate`;
                
                starsContainer.appendChild(star);
            }
            
            // Создаем падающие звезды
            createShootingStars();
        }

        // Создание падающих звезд
        function createShootingStars() {
            // Удаляем старые падающие звезды
            const oldStars = document.querySelectorAll('.shooting-star');
            oldStars.forEach(star => star.remove());
            
            // Создаем новые
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const shootingStar = document.createElement('div');
                    shootingStar.classList.add('shooting-star');
                    
                    const x = Math.random() * 100;
                    const y = Math.random() * 30;
                    const duration = Math.random() * 1 + 0.5;
                    const delay = Math.random() * 10;
                    
                    shootingStar.style.left = `${x}%`;
                    shootingStar.style.top = `${y}%`;
                    shootingStar.style.animation = `shootStar ${duration}s linear ${delay}s`;
                    
                    starsContainer.appendChild(shootingStar);
                    
                    // Удаляем после анимации
                    setTimeout(() => {
                        if (shootingStar.parentNode) {
                            shootingStar.remove();
                        }
                    }, (duration + delay) * 1000);
                }, i * 3000);
            }
            
            // Повторяем создание падающих звезд
            setTimeout(createShootingStars, 15000);
        }

        // Анимация для падающих звезд
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shootStar {
                0% { transform: translateX(0) translateY(0); opacity: 0; }
                10% { opacity: 1; }
                100% { transform: translateX(-100px) translateY(100px); opacity: 0; }
            }
            
            @keyframes twinkle {
                0%, 100% { opacity: 0.2; }
                50% { opacity: 1; }
            }
        `;
        document.head.appendChild(style);

        // Выбор сложности
        function setDifficulty(level) {
            difficulty = level;
            
            // Обновляем активную кнопку
            difficultyButtons.forEach(btn => {
                if (btn.dataset.level === level) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Устанавливаем количество пар
            switch(level) {
                case 'easy':
                    totalPairs = 4;
                    difficultyDisplay.textContent = 'ЛЁГКИЙ';
                    break;
                case 'medium':
                    totalPairs = 8;
                    difficultyDisplay.textContent = 'СРЕДНИЙ';
                    break;
                case 'hard':
                    totalPairs = 12;
                    difficultyDisplay.textContent = 'СЛОЖНЫЙ';
                    break;
            }
            
            totalCards = totalPairs * 2;
            
            // Если игра уже начата, перезапускаем
            if (gameStarted) {
                startGame();
            }
        }

        // Создание карточек для игры
        function createCards() {
            // Очищаем игровое поле
            gameBoard.innerHTML = '';
            
            // Выбираем планеты в зависимости от сложности
            let selectedPlanets = [];
            if (difficulty === 'easy') {
                selectedPlanets = planets.slice(0, 4);
            } else if (difficulty === 'medium') {
                selectedPlanets = planets.slice(0, 8);
            } else {
                selectedPlanets = planets.slice(0, 12);
            }
            
            // Сохраняем выбранные планеты для использования в игре
            gamePlanets = [...selectedPlanets];
            
            // Создаем два набора карточек (пары)
            const gameCards = [...selectedPlanets, ...selectedPlanets];
            
            // Перемешиваем карточки
            gameCards.sort(() => Math.random() - 0.5);
            
            // Настройка сетки в зависимости от количества карточек
            if (difficulty === 'easy') {
                gameBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
            } else if (difficulty === 'medium') {
                gameBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
            } else {
                gameBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
            }
            
            // Создаем карточки
            gameCards.forEach((planet, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.id = index;
                card.dataset.planet = planet.name;
                
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front">
                            <i class="fas fa-question"></i>
                            <p>ИССЛЕДОВАТЬ</p>
                        </div>
                        <div class="card-back">
                            <div class="planet-icon" style="color: ${planet.color}">
                                <i class="${planet.icon}"></i>
                            </div>
                            <div class="planet-name">${planet.name}</div>
                            <div class="planet-desc">${planet.description}</div>
                            <div class="planet-stats">
                                <div class="stat">
                                    <div class="stat-label">ДИАМЕТР</div>
                                    <div class="stat-value">${planet.diameter}</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">СПУТНИКИ</div>
                                    <div class="stat-value">${planet.moons}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                card.addEventListener('click', () => flipCard(card));
                gameBoard.appendChild(card);
            });
            
            // Обновляем прогресс
            updateProgress();
        }

        // Переворачивание карточки
        function flipCard(card) {
            if (!gameStarted) {
                showMessage('Сначала начните игру!', 'warning');
                return;
            }
            
            if (lockBoard || card === firstCard || card.classList.contains('matched')) {
                return;
            }
            
            // Проигрываем звук
            if (soundEnabled) playSound('flip');
            
            card.classList.add('flipped');
            
            if (!firstCard) {
                // Первая карточка
                firstCard = card;
                showMessage(`Открыта ${card.dataset.planet}. Найдите пару!`, 'info');
                return;
            }
            
            // Вторая карточка
            secondCard = card;
            moves++;
            movesDisplay.textContent = moves;
            showMessage(`Открыта ${card.dataset.planet}. Проверяем совпадение...`, 'info');
            lockBoard = true;
            
            checkForMatch();
        }

        // Проверка на совпадение
        function checkForMatch() {
            const isMatch = firstCard.dataset.planet === secondCard.dataset.planet;
            
            if (isMatch) {
                // Совпали
                disableCards();
                matches++;
                matchesDisplay.textContent = `${matches} / ${totalPairs}`;
                
                // Проигрываем звук
                if (soundEnabled) playSound('match');
                
                // Обновляем прогресс
                updateProgress();
                
                showMessage(`Отлично! Вы нашли пару для ${firstCard.dataset.planet}!`, 'success');
                
                if (matches === totalPairs) {
                    endGame();
                }
            } else {
                // Не совпали
                // Проигрываем звук
                if (soundEnabled) playSound('mismatch');
                
                // Анимация несовпадения
                firstCard.classList.add('mismatched');
                secondCard.classList.add('mismatched');
                
                unflipCards();
                showMessage(`Не совпало. Попробуйте еще раз!`, 'danger');
            }
        }

        // Отключение совпавших карточек
        function disableCards() {
            firstCard.classList.add('matched');
            secondCard.classList.remove('mismatched');
            secondCard.classList.add('matched');
            
            resetBoard();
        }

        // Возврат несовпавших карточек
        function unflipCards() {
            setTimeout(() => {
                firstCard.classList.remove('flipped');
                firstCard.classList.remove('mismatched');
                secondCard.classList.remove('flipped');
                secondCard.classList.remove('mismatched');
                
                resetBoard();
            }, 1500);
        }

        // Сброс состояния после проверки
        function resetBoard() {
            [firstCard, secondCard, lockBoard] = [null, null, false];
        }

        // Начало новой игры
        function startGame() {
            gameStarted = true;
            moves = 0;
            matches = 0;
            hints = 3;
            timer = 0;
            
            movesDisplay.textContent = moves;
            matchesDisplay.textContent = `${matches} / ${totalPairs}`;
            timerDisplay.textContent = '00:00';
            hintBtn.innerHTML = '<i class="fas fa-lightbulb"></i> ПОДСКАЗКА (3)';
            
            // Обновляем сообщение
            showMessage('Игра началась! Исследуйте планеты и находите пары!', 'success');
            
            // Запуск таймера
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timer++;
                updateTimerDisplay();
            }, 1000);
            
            // Создание карточек
            createCards();
            
            // Скрыть сообщение о победе
            winOverlay.style.display = 'none';
        }

        // Обновление таймера
        function updateTimerDisplay() {
            const minutes = Math.floor(timer / 60).toString().padStart(2, '0');
            const seconds = (timer % 60).toString().padStart(2, '0');
            timerDisplay.textContent = `${minutes}:${seconds}`;
        }

        // Обновление прогресса
        function updateProgress() {
            const progress = Math.round((matches / totalPairs) * 100);
            progressDisplay.textContent = progress;
            progressBar.style.width = `${progress}%`;
        }

        // Завершение игры
        function endGame() {
            clearInterval(timerInterval);
            gameStarted = false;
            
            // Расчет очков
            const score = calculateScore();
            
            // Показ сообщения о победе
            finalMoves.textContent = moves;
            
            const minutes = Math.floor(timer / 60).toString().padStart(2, '0');
            const seconds = (timer % 60).toString().padStart(2, '0');
            finalTime.textContent = `${minutes}:${seconds}`;
            
            finalScore.textContent = score;
            
            // Рейтинг в звездах
            updateRating(score);
            
            // Сообщение в зависимости от результата
            updateWinMessage(score);
            
            winOverlay.style.display = 'flex';
            
            // Проигрываем звук победы
            if (soundEnabled) playSound('win');
        }

        // Расчет очков
        function calculateScore() {
            // Базовые очки: 1000 за каждую пару
            let score = totalPairs * 1000;
            
            // Бонус за скорость: чем быстрее, тем больше бонус
            const timeBonus = Math.max(0, 5000 - timer * 10);
            score += timeBonus;
            
            // Бонус за эффективность: чем меньше ходов, тем больше бонус
            const minMoves = totalPairs * 2;
            const movesBonus = Math.max(0, 3000 - (moves - minMoves) * 50);
            score += movesBonus;
            
            // Штраф за использование подсказок
            const hintsUsed = 3 - hints;
            score -= hintsUsed * 200;
            
            // Ограничиваем минимальный счет
            return Math.max(100, Math.round(score));
        }

        // Обновление рейтинга в звездах
        function updateRating(score) {
            ratingStars.innerHTML = '';
            
            // Максимальный возможный счет
            const maxScore = totalPairs * 1000 + 5000 + 3000;
            const rating = Math.min(5, Math.ceil((score / maxScore) * 5));
            
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('i');
                if (i <= rating) {
                    star.className = 'fas fa-star';
                } else {
                    star.className = 'far fa-star';
                }
                ratingStars.appendChild(star);
            }
        }

        // Обновление сообщения о победе
        function updateWinMessage(score) {
            let message = '';
            
            if (score > 15000) {
                message = 'Потрясающе! Вы - настоящий космический гений!';
            } else if (score > 10000) {
                message = 'Отличный результат! Вы - опытный исследователь космоса!';
            } else if (score > 5000) {
                message = 'Хорошая работа! Вы знаете планеты Солнечной системы!';
            } else {
                message = 'Неплохо! Продолжайте исследовать космос!';
            }
            
            winMessage.textContent = message;
        }

        // Функция подсказки
        function showHint() {
            if (!gameStarted) {
                showMessage('Сначала начните игру!', 'warning');
                return;
            }
            
            if (hints <= 0) {
                showMessage('Подсказки закончились!', 'warning');
                return;
            }
            
            // Находим все несовпавшие и не перевернутые карточки
            const unmatchedCards = Array.from(document.querySelectorAll('.card:not(.matched):not(.flipped)'));
            
            if (unmatchedCards.length === 0) return;
            
            // Уменьшаем количество подсказок
            hints--;
            hintBtn.innerHTML = `<i class="fas fa-lightbulb"></i> ПОДСКАЗКА (${hints})`;
            
            // Выбираем случайную карточку для подсказки
            const randomCard = unmatchedCards[Math.floor(Math.random() * unmatchedCards.length)];
            
            // Анимация подсказки
            randomCard.style.animation = 'pulse 1s 3';
            showMessage(`Подсказка! Обратите внимание на эту карточку!`, 'info');
            
            // Проигрываем звук
            if (soundEnabled) playSound('hint');
            
            // Сбрасываем анимацию после завершения
            setTimeout(() => {
                randomCard.style.animation = '';
            }, 3000);
        }

        // Переключение звука
        function toggleSound() {
            soundEnabled = !soundEnabled;
            soundBtn.innerHTML = `<i class="fas fa-volume-${soundEnabled ? 'up' : 'mute'}"></i> ЗВУК: ${soundEnabled ? 'ВКЛ' : 'ВЫКЛ'}`;
            
            // Проигрываем тестовый звук при включении
            if (soundEnabled) playSound('flip');
        }

        // Проигрывание звуков (эмуляция)
        function playSound(type) {
            // В реальном приложении здесь были бы настоящие звуковые файлы
            console.log(`Playing sound: ${type}`);
            
            // Для демонстрации создаем простые звуки с помощью Web Audio API
            if (window.AudioContext) {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                let frequency = 440;
                let duration = 0.1;
                
                switch(type) {
                    case 'flip':
                        frequency = 523.25; // C5
                        duration = 0.1;
                        break;
                    case 'match':
                        frequency = 659.25; // E5
                        duration = 0.3;
                        break;
                    case 'mismatch':
                        frequency = 392; // G4
                        duration = 0.2;
                        break;
                    case 'win':
                        // Мажорный аккорд
                        playChord([523.25, 659.25, 783.99]);
                        return;
                    case 'hint':
                        frequency = 830.61; // G#5
                        duration = 0.2;
                        break;
                }
                
                // Создаем звук
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            }
        }

        // Проигрывание аккорда (для победы)
        function playChord(frequencies) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const duration = 0.5;
            
            frequencies.forEach((freq, index) => {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = freq;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                }, index * 100);
            });
        }

        // Показать сообщение с разными типами
        function showMessage(text, type = 'info') {
            messageDisplay.textContent = text;
            
            // Сбрасываем цвет
            messageDisplay.style.color = '';
            
            // Устанавливаем цвет в зависимости от типа
            switch(type) {
                case 'success':
                    messageDisplay.style.color = '#2ecc71';
                    break;
                case 'warning':
                    messageDisplay.style.color = '#f39c12';
                    break;
                case 'danger':
                    messageDisplay.style.color = '#e74c3c';
                    break;
                case 'info':
                    messageDisplay.style.color = '#4a9ff5';
                    break;
            }
        }

        // Сброс игры
        function resetGame() {
            gameStarted = false;
            clearInterval(timerInterval);
            createCards();
            
            moves = 0;
            matches = 0;
            hints = 3;
            timer = 0;
            
            movesDisplay.textContent = moves;
            matchesDisplay.textContent = `${matches} / ${totalPairs}`;
            timerDisplay.textContent = '00:00';
            hintBtn.innerHTML = '<i class="fas fa-lightbulb"></i> ПОДСКАЗКА (3)';
            
            showMessage('Игра сброшена. Нажмите "НОВАЯ ИГРА" чтобы начать!', 'info');
            updateProgress();
            
            winOverlay.style.display = 'none';
        }

        // Инициализация игры
        function initGame() {
            createStars();
            createCards();
            
            // Назначение обработчиков событий
            startBtn.addEventListener('click', startGame);
            hintBtn.addEventListener('click', showHint);
            soundBtn.addEventListener('click', toggleSound);
            resetBtn.addEventListener('click', resetGame);
            playAgainBtn.addEventListener('click', startGame);
            
            // Обработчики для кнопок сложности
            difficultyButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    setDifficulty(btn.dataset.level);
                });
            });
            
            // Инициализация сообщения
            showMessage('Нажмите "НОВАЯ ИГРА", чтобы начать космическое приключение!', 'info');
        }

        // Запуск игры при загрузке страницы
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
